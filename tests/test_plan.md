# ✅ テスト設計書（HealthyBloom）

## 🎯 テストの目的

- 健康診断データ、ユーザー情報、食事提案の主要機能が正しく動作することを保証する。
- エンドポイントのレスポンス、バリデーション、認証トークンの確認を目的とする。
- FastAPI + PostgreSQL におけるAPIの整合性と信頼性を確保する。

---

## 🧪 テストケース一覧

### 🏥 健康診断データ管理

| No | 機能名             | 入力例              | 条件                         | 期待結果                         | 実施状況 |
|----|--------------------|---------------------|------------------------------|----------------------------------|----------|
| 1  | 新規登録           | 正常な健診データ     | POST /health-records         | ステータス200、登録成功         | ✅ 済    |
| 2  | 入力バリデーション | 欠けた値             | 不完全なJSON                 | ステータス422（バリデーション） | ⏳ 未    |
| 3  | 一覧取得           | ―                   | GET /health-records          | ステータス200、一覧が返る       | ✅ 済    |
| 4  | 更新               | 正常な変更データ     | PUT /health-records/{id}     | ステータス200、更新内容確認     | ⏳ 未    |
| 5  | 削除               | ―                   | DELETE /health-records/{id}  | ステータス200、削除確認         | ⏳ 未    |

---

### 🔐 認証機能

| No | 機能名    | 入力         | 条件                      | 期待結果                    | 実施状況 |
|----|-----------|--------------|---------------------------|-----------------------------|----------|
| 6  | ログイン  | 正しいJWT    | POST /auth/login          | ステータス200、トークン取得 | ⏳ 未    |
| 7  | 未認証    | トークンなし | 保護APIへのアクセス       | ステータス401 Unauthorized  | ⏳ 未    |

※ テスト時は Firebase 認証を `TESTING=1` によって無効化しています。

---

### 🍱 食事提案機能

| No | 機能名        | 条件                        | 期待結果                         | 実施状況 |
|----|---------------|-----------------------------|----------------------------------|----------|
| 8  | メニュー取得   | GET /plan/meal              | 栄養バランスの取れたJSONが返る  | ⏳ 未    |
| 9  | ユーザー差異   | 健診値に差をつけて取得       | 個別に異なるメニューが返る       | ⏳ 未    |

---

## 📝 テスト実行方法

```bash
# 仮想環境を有効化
source .venv/bin/activate  # または .venv\Scripts\activate（Windows）

# パッケージをインストール（必要な場合）
pip install pytest httpx pytest-asyncio

# Firebase を無効化した状態でテスト実行
TESTING=1 pytest tests/
